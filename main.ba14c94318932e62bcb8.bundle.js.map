{"version":3,"file":"main.ba14c94318932e62bcb8.bundle.js","sources":["webpack:///./src/FlightSearch/SearchCity/SearchCity.js"],"sourcesContent":["import React from \"react\";\nimport mouseCheckOutside from \"../helper.js\";\nimport {\n\tTextBox,\n\tMainWrapper,\n\tSearchSuggestion,\n\tPopularDestination,\n\tPopularTitle,\n\tPopularContent,\n\tPopularCountry,\n\tPopularCity,\n\tSuggestionList,\n\tSuggestionItem,\n\tColumnWrapper,\n\tMobileInput,\n\tMobileSuggestionWrapper\n} from \"./SearchCityStyle.js\";\n\nimport { listData, popularData } from \"./airport\";\n\nclass SearchCity extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tisSuggestionOpen: false,\n\t\t\tisPopularShow: true,\n\t\t\tselectedCity: { cityName: \"\", airportCode: null },\n\t\t\ttextBoxValue: \"\",\n\t\t\tregex: null\n\t\t};\n\n\t\tthis.tempText = \"\";\n\n\t\tthis.airportList = props.airportList || listData;\n\t\tthis.popularList = props.popularList || popularData;\n\n\t\tthis.toggleSuggetion = this.toggleSuggetion.bind(this);\n\t\tthis.textBoxChange = this.textBoxChange.bind(this);\n\t\tthis.renderPopularDestination = this.renderPopularDestination.bind(this);\n\t\tthis.renderSuggestionListItem = this.renderSuggestionListItem.bind(this);\n\t\tthis.destinationSelected = this.destinationSelected.bind(this);\n\t\tthis.setNode = this.setNode.bind(this);\n\t\tthis.checkMouseClick = this.checkMouseClick.bind(this);\n\t}\n\n\tstatic getDerivedStateFromProps(props, state) {\n\t\tif (props.value.airportCode !== state.selectedCity.airportCode) {\n\t\t\treturn { selectedCity: props.value };\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetNode(node) {\n\t\tthis.mainWrapper = node;\n\t}\n\n\ttoggleSuggetion() {\n\t\tif (this.state.isSuggestionOpen === false && !this.props.isMobile) {\n\t\t\tdocument.body.addEventListener(\"click\", this.checkMouseClick);\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\n\t\tthis.setState(prev => ({\n\t\t\tisSuggestionOpen: true\n\t\t}));\n\t}\n\n\tcheckMouseClick(event) {\n\t\t// mouseCheckOutside return true (mouse clicked outside target) & false (mouse clicked inside target)\n\t\tlet value = mouseCheckOutside(event, this.mainWrapper);\n\n\t\tif (value) {\n\t\t\tthis.setState(\n\t\t\t\tprev => ({\n\t\t\t\t\tisSuggestionOpen: !prev.isSuggestionOpen\n\t\t\t\t}),\n\t\t\t\t() => {\n\t\t\t\t\tdocument.body.removeEventListener(\"click\", this.checkMouseClick);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\ttextBoxChange(evt) {\n\t\tconst { isPopularShow } = this.state;\n\t\tconst target = evt.target;\n\t\tlet temp = false;\n\n\t\tthis.tempText = this.tempText + target.value;\n\n\t\tif (target.value.length < 1 && !isPopularShow) {\n\t\t\ttemp = true;\n\t\t}\n\n\t\tthis.setState({\n\t\t\tisPopularShow: temp,\n\t\t\ttextBoxValue: target.value,\n\t\t\tselectedCity: { cityName: \"\" }\n\t\t});\n\t}\n\n\thighlightWord(word, target, startIndex) {\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t{word.slice(0, startIndex)}\n\t\t\t\t<b>{word.slice(startIndex, startIndex + target.length)}</b>\n\t\t\t\t{word.slice(startIndex + target.length, word.length + 1)}\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n\n\trenderSuggestionListItem() {\n\t\tlet invalid = /[°\"§%()\\[\\]{}=\\\\?´`'#<>|,;.:+_-]+/g;\n\t\tlet regex = new RegExp(this.state.textBoxValue.replace(invalid, \"\"), \"i\");\n\n\t\t// ------\n\t\tlet finishData = [];\n\n\t\tthis.airportList.map(countryData => {\n\t\t\tif (countryData.name.match(regex) !== null) {\n\t\t\t\tfinishData.push(Object.assign({}, countryData));\n\t\t\t} else {\n\t\t\t\tlet tempCountry = {\n\t\t\t\t\tname: countryData.name,\n\t\t\t\t\tcities: []\n\t\t\t\t};\n\n\t\t\t\tcountryData.cities.map(cityData => {\n\t\t\t\t\tconst allAirportCode = cityData.code ? cityData.code : \"\";\n\t\t\t\t\tconst resultCity = cityData.name.match(regex);\n\t\t\t\t\tconst resultAllAirport = allAirportCode.match(regex);\n\n\t\t\t\t\tif (resultCity || resultAllAirport) {\n\t\t\t\t\t\tconst tempObj = Object.assign({}, cityData);\n\n\t\t\t\t\t\tif (resultCity) {\n\t\t\t\t\t\t\ttempObj.cityName = tempObj.name;\n\t\t\t\t\t\t\ttempObj.name = this.highlightWord(\n\t\t\t\t\t\t\t\ttempObj.name,\n\t\t\t\t\t\t\t\tthis.state.textBoxValue,\n\t\t\t\t\t\t\t\tresultCity.index\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttempObj.code = this.highlightWord(\n\t\t\t\t\t\t\t\ttempObj.code,\n\t\t\t\t\t\t\t\tthis.state.textBoxValue,\n\t\t\t\t\t\t\t\tresultAllAirport.index\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (tempObj.airports.length > 0) tempCountry.cities.push(tempObj);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet temp = {\n\t\t\t\t\t\t\tname: cityData.name,\n\t\t\t\t\t\t\tid: cityData.id,\n\t\t\t\t\t\t\tairports: []\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tcityData.airports.map(airportData => {\n\t\t\t\t\t\t\tconst resultAirportCode = airportData.id.match(regex);\n\t\t\t\t\t\t\tconst resultAirportName = airportData.name.match(regex);\n\n\t\t\t\t\t\t\tif (resultAirportCode || resultAirportName) {\n\t\t\t\t\t\t\t\tlet tempObjAirport = Object.assign({}, airportData);\n\n\t\t\t\t\t\t\t\tif (resultAirportCode) {\n\t\t\t\t\t\t\t\t\ttempObjAirport.id = this.highlightWord(\n\t\t\t\t\t\t\t\t\t\ttempObjAirport.id,\n\t\t\t\t\t\t\t\t\t\tthis.state.textBoxValue,\n\t\t\t\t\t\t\t\t\t\tresultAirportCode.index\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttempObjAirport.name = this.highlightWord(\n\t\t\t\t\t\t\t\t\t\ttempObjAirport.name,\n\t\t\t\t\t\t\t\t\t\tthis.state.textBoxValue,\n\t\t\t\t\t\t\t\t\t\tresultAirportName.index\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttemp.airports.push(tempObjAirport);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (temp.airports.length > 0) {\n\t\t\t\t\t\t\ttempCountry.cities.push(temp);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (tempCountry.cities.length > 0) {\n\t\t\t\t\tfinishData.push(tempCountry);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t// ------\n\n\t\treturn finishData.map((countryData, x) => {\n\t\t\treturn (\n\t\t\t\t<SuggestionItem key={x.toString()}>\n\t\t\t\t\t<div className=\"country\">{countryData.name}</div>\n\t\t\t\t\t{countryData.cities.map((cityData, y) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"city_wrapper\" key={y.toString()}>\n\t\t\t\t\t\t\t\t{cityData.airports.length === 1 && (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tonClick={this.destinationSelected}\n\t\t\t\t\t\t\t\t\t\tdata-airportcode={\n\t\t\t\t\t\t\t\t\t\t\tcityData.code ? cityData.code : cityData.airports[0].id\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdata-cityname={\n\t\t\t\t\t\t\t\t\t\t\tcityData.cityName ? cityData.cityName : cityData.name\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{cityData.name} ({cityData.airports[0].id}) -{\" \"}\n\t\t\t\t\t\t\t\t\t\t{cityData.airports[0].name}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{cityData.airports.length > 1 && (\n\t\t\t\t\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tonClick={this.destinationSelected}\n\t\t\t\t\t\t\t\t\t\t\tdata-airportcode={\n\t\t\t\t\t\t\t\t\t\t\t\tcityData.code ? cityData.code : cityData.airports[0].id\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdata-cityname={\n\t\t\t\t\t\t\t\t\t\t\t\tcityData.cityName ? cityData.cityName : cityData.name\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{cityData.name} ({cityData.code}) - Semua Bandara\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t{cityData.airports.map((airportData, z) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={z.toString()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={this.destinationSelected}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-airportcode={airportData.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-cityname={cityData.cityName}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{cityData.name} ({airportData.id}) -{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{airportData.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</SuggestionItem>\n\t\t\t);\n\t\t});\n\t}\n\n\trenderPopularDestination() {\n\t\treturn this.popularList.map((country, index) => {\n\t\t\treturn (\n\t\t\t\t<div key={index.toString()}>\n\t\t\t\t\t<PopularCountry>{country.countryName}</PopularCountry>\n\t\t\t\t\t<PopularCity>\n\t\t\t\t\t\t{country.cities.map((city, index) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div key={index.toString()}>\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tonClick={this.destinationSelected}\n\t\t\t\t\t\t\t\t\t\tdata-airportcode={city.id}\n\t\t\t\t\t\t\t\t\t\tdata-cityname={city.name}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{city.name}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</PopularCity>\n\t\t\t\t</div>\n\t\t\t);\n\t\t});\n\t}\n\n\tdestinationSelected(evt) {\n\t\tconst airportCode = evt.target.dataset.airportcode;\n\t\tconst cityName = evt.target.dataset.cityname;\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tisSuggestionOpen: false,\n\t\t\t\tselectedCity: { cityName: cityName, airportCode: airportCode }\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tdocument.body.removeEventListener(\"click\", this.checkMouseClick);\n\t\t\t\tthis.props.onChange(this.props.id, {\n\t\t\t\t\tcityName: cityName,\n\t\t\t\t\tairportCode: airportCode\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tmaxHeight,\n\t\t\tmaxWidth,\n\t\t\tsuggestionWidth,\n\t\t\tcolumn,\n\t\t\tright,\n\t\t\tisMobile\n\t\t} = this.props;\n\t\tconst {\n\t\t\tisSuggestionOpen,\n\t\t\tisPopularShow,\n\t\t\tselectedCity,\n\t\t\ttextBoxValue\n\t\t} = this.state;\n\t\tconst {\n\t\t\ttoggleSuggetion,\n\t\t\ttextBoxChange,\n\t\t\trenderSuggestionListItem,\n\t\t\trenderPopularDestination,\n\t\t\tsetNode\n\t\t} = this;\n\n\t\tconst searchBoxValue = selectedCity.cityName\n\t\t\t? `${selectedCity.cityName} (${selectedCity.airportCode})`\n\t\t\t: textBoxValue;\n\n\t\tif (!isMobile) {\n\t\t\treturn (\n\t\t\t\t<MainWrapper ref={setNode}>\n\t\t\t\t\t<TextBox\n\t\t\t\t\t\tplaceholder=\"Kota atau Bandara\"\n\t\t\t\t\t\tonClick={toggleSuggetion}\n\t\t\t\t\t\tmaxWidth={maxWidth}\n\t\t\t\t\t\tonChange={textBoxChange}\n\t\t\t\t\t\tvalue={searchBoxValue}\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t/>\n\t\t\t\t\t<SearchSuggestion\n\t\t\t\t\t\tisOpen={isSuggestionOpen}\n\t\t\t\t\t\tmaxHeight={maxHeight}\n\t\t\t\t\t\tright={right}\n\t\t\t\t\t>\n\t\t\t\t\t\t<PopularDestination isShow={isPopularShow}>\n\t\t\t\t\t\t\t<PopularTitle>Destinasi Populer</PopularTitle>\n\t\t\t\t\t\t\t<PopularContent width={suggestionWidth} maxHeight={maxHeight}>\n\t\t\t\t\t\t\t\t<ColumnWrapper column={column}>\n\t\t\t\t\t\t\t\t\t{renderPopularDestination()}\n\t\t\t\t\t\t\t\t</ColumnWrapper>\n\t\t\t\t\t\t\t</PopularContent>\n\t\t\t\t\t\t</PopularDestination>\n\t\t\t\t\t\t{!isPopularShow && (\n\t\t\t\t\t\t\t<SuggestionList width={suggestionWidth} maxHeight={maxHeight}>\n\t\t\t\t\t\t\t\t{renderSuggestionListItem()}\n\t\t\t\t\t\t\t</SuggestionList>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</SearchSuggestion>\n\t\t\t\t</MainWrapper>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t<MobileInput\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder=\"Pilih Kota atau Bandara\"\n\t\t\t\t\t\tonClick={toggleSuggetion}\n\t\t\t\t\t\tonChange={textBoxChange}\n\t\t\t\t\t\tvalue={searchBoxValue}\n\t\t\t\t\t/>\n\t\t\t\t\t<MobileSuggestionWrapper>\n\t\t\t\t\t\t{/*---*/}\n\t\t\t\t\t\t<PopularDestination isShow={isPopularShow} isMobile>\n\t\t\t\t\t\t\t<PopularTitle isMobile>Destinasi Populer</PopularTitle>\n\t\t\t\t\t\t\t<PopularContent isMobile>\n\t\t\t\t\t\t\t\t<ColumnWrapper column={column}>\n\t\t\t\t\t\t\t\t\t{renderPopularDestination()}\n\t\t\t\t\t\t\t\t</ColumnWrapper>\n\t\t\t\t\t\t\t</PopularContent>\n\t\t\t\t\t\t</PopularDestination>\n\t\t\t\t\t\t{/*---*/}\n\t\t\t\t\t\t{!isPopularShow && (\n\t\t\t\t\t\t\t<SuggestionList>{renderSuggestionListItem()}</SuggestionList>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{/*---*/}\n\t\t\t\t\t</MobileSuggestionWrapper>\n\t\t\t\t</React.Fragment>\n\t\t\t);\n\t\t}\n\t}\n}\n\nexport default SearchCity;\n"],"mappings":"AAAA","sourceRoot":""}